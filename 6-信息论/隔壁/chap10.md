--- PAGE 1 ---

信息的量化：

连续情形

10

本讲介绍研究连续随机变量信息量时的一些基本事实。

在物理世界中，连续随机变量很常见，其中的信源和信道通常由连续的物理定律支配。

例如，信源可能是一个对环境进行模拟（即连续）测量的传感器，而信道可能包含最好被建模为连续随机变量（如高斯变量）的噪声。

由于对一般随机变量（包括连续、连续-离散混合，甚至更抽象的类型）的信息量进行数学上严谨的处理需要高深的数学工具，我们将满足于一种很大程度上是启发式的处理方法，并提供一些未经证明的进阶结果。

10.1 从熵到微分熵. 111

10.2 最大熵密度. 115

10.3 熵功率不等式 117

10.4 互信息. 118

10.1 从熵到微分熵

回想一下，对于一个离散随机变量 X∼PX(x)，x∈x，其熵在定义 2.10 中定义为

I(X)=−∑x∈XPX(x)log PX(x).

(10.1)

现在，考虑实数线上的一个连续随机变量 X。

我们假设 X 有一个概率密度函数 fX(x), x∈S⊆R。

这里 S 表示 fX(x) 不为零的集合，称为 X 的支撑集。

如何将熵的概念扩展到这样一个连续的 X？

一个看似合理的想法是将 X 离散化为一个“量化”的离散变量，然后让离散化越来越精细。

鉴于此，固定一个离散化单元大小 δ，并考虑一个具有概率质量函数（pmf）的离散随机变量 X~δ

PXδ(i)=∫iδ(i+1)δfX(x)dx,

(10.2)

对于 i=...,−1,0,1,...。也就是说，我们将实数线划分为大小为 δ 的区间，称为“单元”，并通过为每个单元分配 X 在该单元中出现的概率，将连续随机变量 X 离散化到这些单元中。

--- PAGE 2 ---

112

10 信息的量化：连续情形

在对 fX 做温和假设的情况下，根据中值定理，对每个 i，存在某个 xi∈[iδ,(i+1)δ]，使得

PX~δ(i)=fX(xi)δ.

(10.3)

据此，计算 X~δ 的熵，我们得到

$\begin{matrix}H(\tilde{X}_{\delta})&=&-\sum_{i}P_{\tilde{X}_{\delta}}(i)log~P_{\tilde{X}_{\delta}}(i)$

=−∑ifX(xi)δ log(fX(xi)δ)

=−∑ifX(xi)δ log fX(xi)−∑ifX(xi)δ log δ,(10.4)

其中第一项收敛于

−∫δfX(x)log fX(x)dx,

(10.5)

如果这个积分存在，当 δ→0 时，第二项恰好是 log δ。

因此，我们看到

limδ→0[H(X~δ)−logδ1]=−∫δfX(x)log fX(x)dx

(10.6)

也就是说，如果我们试图将连续随机变量的熵定义为其在精细离散化极限下的离散化熵，这通常会导致无穷大的熵，因为当 δ→0 时，logδ1 发散。

然而，在去除了这个 logδ1 主导项之后，剩余的偏差项 −∫δfX(x)log fX(x)dx 提供了一个衡量 X 熵的相对度量。

鉴于前面的讨论，我们引入微分熵的定义。

定义 10.1 对于一个在实数线上定义的连续随机变量 X，其概率密度函数为 fX(x)，x∈S⊆R，其微分熵定义为

h(X)=h(fX)=−∫SfX(x)log fX(x)dx. (10.7)

如果该积分存在。

备注 10.1 前面微分熵的“推导”本质上是启发式的。

特别是，它严重依赖于使用统一大小的单元对实数线进行离散化。

很容易验证，如果应用非均匀离散化，那么离散化随机变量的熵的渐近行为将不会产生如 (10.6) 所示的简单形式。

总之，一个谨慎的观点是

--- PAGE 3 ---

10.1 从熵到微分熵 113

将微分熵视为一个独立的数学实体，而不是熵的扩展。

我们可以将微分熵的概念扩展到多个随机变量。

定义 10.2 对于一个在 Rk 上定义的连续随机向量 X，其联合概率密度函数为 fX(x)，x∈δ⊆Rk，其微分熵定义为

h(X)=h(fX)=−∫SfX(x)log fX(x)dx, (10.8)

如果该积分存在。

我们也可以为一对随机变量定义条件微分熵。

定义 10.3 对于一对随机变量 X 和 Y，其联合概率密度函数为 fX,Y(x,y), (x,y)∈δ⊆Rk×Rl, 条件微分熵定义为

h(Y∣X)=−∫SfX,Y(x,y)log fY∣X(y∣x)dxdy, (10.9)

如果该积分存在。

当 X 是一个离散随机变量时，只要对于每个 X=x，fY∣X 存在，我们仍然可以定义条件微分熵 h(Y∣X), 如下：

h(Y∣X)=−∑x∈XPX(x)∫SxfY∣X(y∣x)log fY∣X(y∣x)dy. (10.10)

如果该积分存在，其中 Sx 是 fY∣X(y∣x) 的支撑集。

示例 10.1 设 X 为均匀分布，fX(x)=b−a1，x∈[a,b]。

X 的微分熵为

h(X)=∫abb−a1log(b−a)dx=log(b−a) 奈特。 (10.11)

注意当 b−a<1, h(X)<0. 所以微分熵不必是非负的。

示例 10.2 设 X 为指数分布，fX(x)=be−bx，x≥0。X 的微分熵为

h(X)=∫0∞fX(x)(bx−ln b)dx

=bE[X]−ln b

=bb1−ln b=1−ln b 奈特。

(10.12)

--- PAGE 4 ---

114

10 信息的量化：连续情形

示例 10.3 令 X 为高斯分布，其 fX(x)=2πσ2![img](data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702%0Ac-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14%0Ac0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54%0Ac44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10%0As173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429%0Ac69,-144,104.5,-217.7,106.5,-221%0Al0 -0%0Ac5.3,-9.3,12,-14,20,-14%0AH400000v40H845.2724%0As-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7%0Ac-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z%0AM834 80h400000v40h-400000z"></path></svg>)1e−2σ2(x−μ)2,x∈R. X 的微分熵为

h(X)=∫−∞∞fX(x)[2σ2(x−μ)2+21ln(2πσ2)]dx

=2σ21var[X]+21ln(2πσ2)

=21ln(2πeσ2) 奈特。

(10.13)

示例 10.4 设 X 为一个 k 维高斯随机向量，其

fX(x)=(2π)k/2∣K∣![img](data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.5429em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702%0Ac-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14%0Ac0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54%0Ac44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10%0As173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429%0Ac69,-144,104.5,-217.7,106.5,-221%0Al0 -0%0Ac5.3,-9.3,12,-14,20,-14%0AH400000v40H845.2724%0As-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7%0Ac-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z%0AM834 80h400000v40h-400000z"></path></svg>)1e−21(x−μ)TK−1(x−μ). (10.14)

其中协方差矩阵 K 是正定的；

即 X∼N(μ,K)。X 的微分熵为

h(X)=∫RkfX(x)[21(x−μ)TK−1(x−μ)+2kln(2π)+21ln∣K∣]dx

$\underline{=}\int_{\mathbb{R}^{k}}\frac{1}{(2\pi)^{k/2}\sqrt{|K|}}e^{-\frac{1}{2}\overline{\underline{A}}^{T}\frac{1}{2}\frac{1}{2}\frac{1}{2}\tilde{\underline{X}}|K^{1/2}|d\underline{\underline{X}}+\frac{k}{2}ln(2\pi)+\frac{1}{2}ln|K|$

$=\frac{1}{2}\int_{\mathbb{R}^{k}}\frac{1}{(2\pi)^{k/2}}e^{-\frac{1}{2}\tilde{\underline{x}}^{T}\underline{\underline{x}}\tilde{\underline{x}}^{T}\underline{\underline{x}}+\frac{k}{2}ln(2\pi)+\frac{1}{2}ln|K|$

=21EN(0,Ik×k)[XTX]+2kln(2π)+21ln∣K∣

=(b)21trEN(0,Ik×k)[X~X~T]+2kln(2π)+21ln∣K∣

=21trIk×k+2kln(2π)+21ln∣K∣

=2kln(2πe)+21ln∣K∣nats,

其中在(a)中我们进行了变量替换 x~=K−1/2(x−μ)，在(b)中我们使用了迹的一个恒等式 tr(AB)=tr(BA)。

(10.15)

熵的一些重要性质在微分熵中也有类似的形式。

命题 10.1 微分熵满足链式法则，即

h(X1,X2,...,Xn)=∑i=1nh(Xi∣Xi−1,...,X1). , (10.16)

其中 X0 理解为退化的。

命题 10.2 条件作用减少微分熵，即

h(Y∣X)≤h(Y),

(10.17)

--- PAGE 5 ---

10.2 最大熵密度 115

当且仅当 X 和 Y 独立时等号成立。

回想一下，对于熵，H(X)=H(f(X)) 当且仅当 f 是一个双射（推论 3.6）。

一般来说，微分熵在变换下不再是不变的，即使变换是双射的。

命题 10.3 考虑一个具有概率密度函数 fX(x), x∈S⊆Rk 的连续随机向量 X。我们有

► 对于任何给定的向量 b，h(X+b)=h(X)。

► 对于任何给定的非奇异方阵 A，h(AX)=h(X)+log∣A∣。

对于两个概率密度函数 fX 和 δx，我们可以以类似于离散情况的方式定义它们的相对熵。

定义 10.4 对于两个概率密度函数 fx 和 gX，它们的相对熵定义为

D(fX∣∣gX)=∫SfX(x)loggX(x)fX(x)dx′

(10.18)

其中 是 fX 或 gX 不为零的支撑集。

注意，如果存在一个区间，其中 gX(x) 为零但 fX(x) 严格为正，则 D(fX∣∣gX)=∞。

可以用类似于离散情况的方式证明相对熵总是非负的。

，等号成立

命题 10.4 对于任何 fX 和 gX，当且仅当在 8 上几乎处处有 fX(x)=gX(x) 时，等号成立。

10.2 最大熵密度

考虑所有满足以下条件的概率密度函数：

► 约束 [0]: ∫SfX(x)dx=1 支撑集为 8；

► 约束 [1] 到 [n⌋:∫SfX(x)ri(x)dx=αi i=1,...,m

定义 10.5 在约束 [0] 到 [m] 下，最大熵概率密度函数定义为

fX∗(x)=eλ0+∑i=1mλiri(x) x∈S,

(10.19)

其中 λ0,λ1,...,λm 的选择使得 fX∗(x) 同时满足约束 [0] 到 [m]。

--- PAGE 6 ---

116

10 信息的量化：连续情形

定理 10.1 最大熵概率密度函数 fX∗(x) 在所有满足约束条件 [0] 至 [m] 的概率密度函数中，使微分熵最大化。

证明：思路是利用相对熵的非负性。

具体来说，考虑一个满足约束条件 [0] 至 [m] 的任意概率密度函数 fX(x)，并计算 D(fX∣∣fX∗)：

D(fX∣∣fX∗)=∫SfX(x)lnfX∗(x)fX(x)dx

=−h(fX)−∫SfX(x)[λ0+∑i=1mλiri(x)]dx

=−h(fX)−λ0∫SfX(x)dx−∑i=1mλi∫SfX(x)ri(x)dx

=−h(fX)−λ0−∑i=1mλiαi

=−h(fX)−λ0∫SfX∗(x)dx−∑i=1mλi∫SfX∗(x)ri(x)dx

=−h(fX)−∫SfX∗(x)[λ0+∑i=1mλiri(x)]dx

=−h(fX)+h(fX∗).

(10.20)

由于 D(fX∣∣fX∗)≥0，当且仅当在 8 上几乎处处 fX(x)=fX∗(x) 时等号成立，我们得出结论 h(fX∗)≥h(fX)。

Π

示例 10.5 考虑在 S=[a,b] 上的所有概率密度函数，没有任何进一步的约束。

所以只有约束 [0] 存在，最大熵概率密度函数是

fX∗(x)=eA0, x∈[a,b].

(10.21)

这意味着 fX∗(x) 在 8 上是一个常数，立即表明 fX∗(x) 应该是一个均匀概率密度函数，即

fX∗(x)=b−a1 x∈[a,b].

(10.22)

示例 10.6 考虑在 S=R 上的所有概率密度函数，满足 E[X]=0 和 E[X2]=σ2。因此，最大熵概率密度函数是

fX∗(x)=eλ0+λ1x+λ2x2,

x∈R.

(10.23)

该概率密度函数的形式与二次型的指数成正比，因此它应该是高斯分布。

均值为零、方差为 σ2 的高斯概率密度函数为

--- PAGE 7 ---

函数是

10.3 熵功率不等式 117

fX∗(x)=2πσ2![img](data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702%0Ac-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14%0Ac0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54%0Ac44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10%0As173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429%0Ac69,-144,104.5,-217.7,106.5,-221%0Al0 -0%0Ac5.3,-9.3,12,-14,20,-14%0AH400000v40H845.2724%0As-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7%0Ac-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z%0AM834 80h400000v40h-400000z"></path></svg>)1e−2σ2x2

(10.24)

这个最大熵概率密度函数在下一讲计算高斯信道的容量-成本函数时将非常有用。

例 10.7 考虑在 S=[0,∞) 上的所有概率密度函数，满足 E[X]=μ. 那么最大熵概率密度函数是

fX∗(x)=eλ0+λ1x x∈[0,∞).

(10.25)

这样的形式立即意味着 fX∗(x) 应该遵循指数概率密度函数，即

fX∗(x)=μ1e−μx, x≥0

(10.26)

在这个例子中，如果我们将支撑集 8 从 [0,∞) 改为 R，那么很容易验证不存在最大熵概率密度。

事实上，令 X 是一个均值为、方差为 σ2 的高斯随机变量，当 σ2→0 时，得到的微分熵是发散的。

10.3 熵功率不等式

对于一个在 R 上的连续随机变量 X，其微分熵为 h(X)，我们称

N(X)=2πe1e2h(X)

h(X)=21ln(2πeN(X)),

为 X 的熵功率。重写

(10.27)

(10.28)

我们立即观察到，当 X 是高斯分布时，N(X) 正是 X 的方差。所以总的来说，N(X) 可以被看作是 X 的方差（即“功率”）的“推广”。

这个想法可以推广到更高维度。

对于在 Rk 上的 X，其微分熵为 h(X)，我们称

N(X)=2πe1eℏ2h(X)

(10.29)

--- PAGE 8 ---

118

10 信息的量化：连续情形

X 的熵功率。当 X 是具有协方差矩阵 K 的高斯分布时，N(X)=∣K∣1/k。

以下基本不等式被称为熵功率不等式（EPI），它关系到两个独立随机向量及其和的熵功率。

定理 10.2 对于在 Rk 上的独立连续随机向量 X 和 Y，我们有

N(X+Y)≥N(X)+N(Y),

(10.30)

当且仅当 X 和 Y 是具有成比例协方差矩阵的高斯分布时，等号成立。

证明 EPI 有几种方法，但似乎没有一种简单到可以在我们的讲义中讲授。

所以我们只给出结果，不提供证明。

10.4 互信息

我们可以通过相对熵（定义 10.4）为一对连续随机变量定义互信息，如下所示。

定义 10.6 对于一对随机变量 X 和 Y，其联合概率密度函数为 fX,Y(x,y)，(x,y)∈S⊆Rk×RI，X 和 Y 之间的互信息定义为

I(X;Y)=D(fX,Y∣∣fXfY)

(10.31)

=∫δfX,Y(x,y)logfX(x)fY(y)fX,Y(x,y)dxdy , (10.32)

如果该积分存在。

备注 10.2 定义 (10.31) 并非一般随机变量互信息的最基本形式。

两个随机变量 X 和 Y 之间互信息最基本也是最通用的定义如下：

I(X; Y) = sup I([X]@x; [Y] ),

QxQy

(10.33)

其中 aX (或 Qy) 表示 X (或 Y) 的一个划分，即 X (或 Y) 的有限或可数个子集，这些子集不相交且其并集为 X (或 Y)。

因此，[X]QY (或 [Y]6v) 表示通过将 [X]QX=i (或 [Y]ΦY=j) 赋给 X (或 Y) 属于由 i (或 j) 索引的子集的概率而获得的离散化随机变量，该划分依据为 @x (或 Qy)。

这个定义适用于非常一般的随机变量，

--- PAGE 9 ---

并且对于具有联合概率密度函数的连续随机变量，它简化为由(10.31)给出的形式。

我们也可以用类似于离散随机变量的方式为三个连续随机变量定义条件互信息。

定义 10.7 对于三个随机变量 X、Y 和 Z，其联合概率密度函数为 fX,Y,Z(x,y,z)，(x,y,z)∈δ⊆Rk×Rl×Rm，给定 Z 时 X 和 Y 之间的条件互信息定义为

I(X;Y∣Z)=∫SfX,Y,Z(x,y,z)logfX∣Z(x∣z)fY∣Z(y∣z)fX,Y∣Z(x,y∣z)dxdyd/0.34)

如果该积分存在。

以下性质对 I(X;Y) 和 I(X;Y∣Z) 成立。

推论 10.1 互信息和条件互信息满足以下性质：

► I(X;Y)≥0, 当且仅当 X 和 Y 独立时等号成立。

►I I(X;Y∣Z)≥0 当且仅当 X↔Z↔Y 时等号成立。

► (DPI) 如果 X↔Y↔Z, 则 I(X;Y)≥I(X;Z), 当且仅当 X↔Z↔Y 也成立时等号成立。

► I(X;Y)=h(Y)−h(Y∣X)。

►I(X; YZ) = h(YZ)h(Y X, Z).

备注 10.3 推论 10.1 的前三个性质是普适的。

后两个性质要求相关微分熵的存在。

尽管如此，当 X 是离散的，且 Y 在给定 X（以及适用时的 Z）的条件下具有条件概率密度函数时，它们也成立，因此在计算具有离散输入 X 和连续输出 Y 的信道互信息时它们非常有用，这在实际通信系统中经常遇到。

注释

微分熵已在香农 1948 年的两部分文章 [1] 中出现，其几个关键性质，包括 EPI，也出现在其中，但没有证明。

对一般随机变量的信息量进行最基本且最普遍的处理，归功于俄罗斯学派；

参见，例如，[5]。

10.4 互信息 119

--- PAGE 10 ---

120

10 信息的量化：连续情形

练习

1. 计算以下概率密度函数的微分熵。 ► 柯西分布：f(x)=πλλ2+x21 δ=R

拉普拉斯分布：f(x)=2λ1e−∣x−θ∣/λ, S=R

► 瑞利分布：f(x)=αxe−αx2/2 2,8 S=[0,∞).

1. 考虑一个独立同分布 (i.i.d.) 的随机变量序列 {Xi,i=1,2,...} 及其样本均值 {Sn,n=1,2,...}, Sn=n1∑i=1nXi。

a) 当 Xi 是离散的，熵为 H(X) 时，计算 n1H(S1,S2,...,Sn)。

b) 当 Xi 是连续的，微分熵为 h(X) 时，计算 n1h(S1,S2,...,Sn)。

3. 对于独立的连续随机变量 X 和 Y，证明 h(X+Y)≥h(X)。

1. 考虑一个 k 维连续随机向量 X。

► 如果 X 的均值为零，协方差矩阵为 K, 那么 Xi 的最大微分熵是多少？

► 证明哈达玛不等式，即 ∣K∣≤∏i=1kKii。

► 证明对数行列式 In ∣K∣ 对于 K 是凹函数。

1. 证明最大熵原理的以下推广：对于任意给定的概率密度函数 gX(x)，x∈δ，最小化 D(fx∣∣gX) 同时满足 ∫δfX(x)ri(x)dx=αi, i=1,2,...,m, 的概率密度函数 fX(x) 由以下形式给出：

fX(x)=gX(x)eλ0+∑i=1mλiri(x),

其中 {λi}i=0,1,...,m 是参数。

6. 验证在标量情况下，EPI可以重写为以下等价形式：对于在R上的独立连续随机变量X和Y，令X~和Y~为满足h(X~)=h(X)和h(Y~)=h(Y)的独立高斯随机变量，则以下不等式成立：

h(X+Y)≥h(X~+Y~)

(10.35)